// const input =[
//     '7 8 1',
//     '0 0 0 0 0 0 0 0',
//     '0 0 0 0 4 0 0 0',
//     '0 0 0 0 0 0 0 0',
//     '0 0 5 0 0 0 0 0',
//     '0 0 0 0 0 0 0 0',
//     '0 0 0 0 0 0 0 0',
//     '0 0 0 0 3 0 0 0',
//     '3',
//     '5 4 0',
//     '4 4 1',
//     '5 6 0'
// ]

// const input = [
// '7 8 1',
// '0 0 0 0 0 0 0 0',
// '0 0 0 0 4 0 0 0',
// '0 0 0 0 0 0 0 0',
// '0 0 5 5 0 0 0 0',
// '0 0 0 0 0 5 0 0',
// '0 0 0 0 0 0 0 0',
// '0 0 0 0 3 0 0 0',
// '3',
// '4 4 1',
// '5 4 0',
// '5 6 0',
// ]
// const input = [
// '7 8 5',
// '0 0 0 0 0 0 0 0',
// '0 0 0 0 4 0 0 0',
// '0 0 0 0 0 0 0 0',
// '0 0 5 5 0 0 0 0',
// '0 0 0 0 0 5 0 0',
// '0 0 0 0 0 0 0 0',
// '0 0 0 0 3 0 0 0',
// '3',
// '4 4 1',
// '5 4 0',
// '5 6 0',
// ]
// const input = [
// '7 8 7',
// '0 0 0 0 0 0 0 0',
// '0 0 0 0 4 0 0 0',
// '0 0 0 0 0 0 0 0',
// '0 0 5 5 0 0 0 0',
// '0 0 0 0 0 5 0 0',
// '0 0 0 0 0 0 0 0',
// '0 0 0 0 3 0 0 0',
// '3',
// '4 4 1',
// '5 4 0',
// '5 6 0',
// ]
// const input = [
//     '7 8 70',
//     '0 0 0 0 0 0 0 0',
//     '0 0 0 0 4 0 0 0',
//     '0 0 0 0 0 0 0 0',
//     '0 0 5 5 0 0 0 0',
//     '0 0 0 0 0 5 0 0',
//     '0 0 0 0 0 0 0 0',
//     '0 0 0 0 3 0 0 0',
//     '3',
//     '4 4 1',
//     '5 4 0',
//     '5 6 0',
//     ]
    // const input = [
    // '7 8 1000',
    // '0 0 0 0 0 0 0 0',
    // '0 0 0 0 4 0 0 0',
    // '0 0 0 0 0 0 0 0',
    // '0 0 5 5 0 0 0 0',
    // '0 0 0 0 0 5 0 0',
    // '0 0 0 0 0 0 0 0',
    // '0 0 0 0 3 0 0 0',
    // '3',
    // '4 4 1',
    // '5 4 0',
    // '5 6 0'
    // ]
    // const input = [
    // '7 8 100',
    // '0 0 0 0 0 0 0 0',
    // '5 0 0 0 4 0 0 0',
    // '0 0 0 0 0 0 0 0',
    // '0 0 5 5 0 0 0 0',
    // '0 0 0 0 0 5 0 0',
    // '5 0 0 0 0 0 5 0',
    // '0 0 0 0 3 0 0 0',
    // '0'
    // ]
    // const input = [
    // '7 8 100',
    // '0 0 0 0 0 0 5 0',
    // '5 4 4 4 4 4 4 0',
    // '0 0 0 0 0 0 0 0',
    // '0 0 5 5 0 0 0 0',
    // '0 0 0 0 0 5 0 0',
    // '5 0 0 0 0 0 5 0',
    // '0 0 0 0 3 0 0 0',
    // '3',
    // '4 4 1',
    // '5 4 0',
    // '5 6 0',
    // ]
    // const input = [
    // '7 8 1000',
    // '0 0 0 0 0 0 5 0',
    // '5 4 4 4 4 4 4 0',
    // '0 0 0 0 0 0 0 0',
    // '0 0 5 5 0 0 0 0',
    // '0 0 0 0 0 5 0 0',
    // '5 0 0 0 0 0 5 0',
    // '0 0 0 0 3 0 0 0',
    // '3',
    // '4 4 1',
    // '5 4 0',
    // '5 6 0',
    // ]
    // const input = [
    // '7 8 1000',
    // '0 0 0 0 0 0 0 0',
    // '4 4 4 4 4 4 4 4',
    // '0 0 0 0 0 5 0 0',
    // '0 0 5 5 0 0 5 0',
    // '0 0 0 0 0 5 0 0',
    // '5 0 0 0 0 0 5 0',
    // '3 3 3 3 3 3 3 3',
    // '3',
    // '4 4 1',
    // '5 4 0',
    // '5 6 0',
    // ]
    // const input =[
    //     '7 8 1',
    //     '0 0 0 0 0 0 0 0',
    //     '0 0 0 0 0 0 0 0',
    //     '1 0 0 0 0 0 0 0',
    //     '0 0 5 0 0 0 0 0',
    //     '0 0 0 0 0 0 0 0',
    //     '0 0 0 0 0 0 0 0',
    //     '0 0 0 0 0 0 0 0',
    //     '1',
    //     '3 4 1',
        
    // ]
//const fs = require('fs');
//const input = fs.readFileSync('/dev/stdin').toString().trim().split('\n');
const [R,C,K] = input[0].split(' ').map(Number);
const map = Array.from({length:R},(_,i)=>input[i+1].split(' ').map(Number));
const W = +input[1+R];
const wallInfo = Array.from({length:W},(_,i) => input[i+2+R].split(' ').map(num => +num -1));
// 1 오른쪽 2 왼쪽 3 위 4 아래 5 온도조절
const dy = [0,0,-1,1];
const dx = [1,-1,0,0];
const wdy = [[-1,1],[-1,1],[0,0],[0,0]];
const wdx = [[0,0],[0,0],[-1,1],[-1,1]];
const isValidPos = (y,x) =>(y>=0 && x>=0 && y<R && x<C);
const decreaseEdgeTemper = (map) =>{
    for(let x=0; x<C-1; x++){
        if(map[0][x]) map[0][x]--;
    }
    for(let y=0; y<R-1; y++){
        if(map[y][C-1]) map[y][C-1]--;
    }
    for(let x=C-1; x>0; x--){
        if(map[R-1][x]) map[R-1][x]--;
    }
    for(let y=R-1; y>0; y--){
        if(map[y][0]) map[y][0] --;
    }
}
const controlTemper = (map,wall) =>{
    let newMap = Array.from({length:R},()=>Array(C).fill(0));
    for(let y=0; y<R; y++){
        for(let x=0; x<C; x++){
            if(!map[y][x]) continue;
            let totalDecrease = 0;
            for(let i=0; i<4; i++){
                const [ny,nx] = [y+dy[i],x+dx[i]];
                if(!isValidPos(ny,nx) || map[y][x] <= map[ny][nx] || wall.has(`${ny},${nx},${y},${x}`)) continue;
                const decrease = Math.floor( (map[y][x] - map[ny][nx]) / 4);
                newMap[ny][nx] += decrease;
                totalDecrease+=decrease;
            }
            newMap[y][x] += ( map[y][x] - totalDecrease);
        }
    }
    return newMap;
}
const blowWind = (warmer,map,wall) =>{
    const [wy,wx,dir] = warmer;
    const [sy,sx] = [wy+dy[dir],wx+dx[dir]];
    let visit = new Set(), k = 5;
    map[sy][sx] += k;
    let queue = [[sy,sx,k-1]] , idx = 0;
    while(idx < queue.length){
        const [y,x,temper] = queue[idx++];
        if(temper === 0) return;
        const [ny,nx] = [y+dy[dir],x+dx[dir]];
        const [nuy,nux] = [y+dy[dir]+wdy[dir][0],x+dx[dir]+wdx[dir][0]];
        const [ndy,ndx] = [y+dy[dir]+wdy[dir][1],x+dx[dir]+wdx[dir][1]];
        if(isValidPos(ny,nx) && !visit.has(`${ny},${nx}`) && !wall.has(`${ny},${nx},${y},${x}`)){
            visit.add(`${ny},${nx}`);
            queue.push([ny,nx,temper-1]);
            map[ny][nx] += temper;
        } 
        if(isValidPos(nuy,nux) && !visit.has(`${nuy},${nux}`)){
            const [py,px] = [nuy-dy[dir],nux-dx[dir]];
            if(!wall.has(`${nuy},${nux},${py},${px}`) && !wall.has(`${py},${px},${y},${x}`)){
                visit.add(`${nuy},${nux}`);
                queue.push([nuy,nux,temper-1]);
                map[nuy][nux] +=temper;
            }
        }
        if(isValidPos(ndy,ndx) && !visit.has(`${ndy},${ndx}`)){
            const [py,px] = [ndy-dy[dir],ndx-dx[dir]];
            if(!wall.has(`${ndy},${ndx},${py},${px}`) && !wall.has(`${py},${px},${y},${x}`)){
                visit.add(`${ndy},${ndx}`);
                queue.push([ndy,ndx,temper-1]);
                map[ndy][ndx] +=temper;
            }
        }
    } 


}
const solution = (map) =>{
     let checkTemper = [] , warmer = [] , wall = new Set();
     for(let y=0; y<R; y++){
         for(let x=0; x<C; x++){
             if(map[y][x] === 5) checkTemper.push([y,x]) , map[y][x] =0;
             else if(map[y][x] && map[y][x] !==5) warmer.push([y,x,map[y][x]-1]) , map[y][x] = 0;
         }
     }
     for(let i=0; i<wallInfo.length; i++){
         const [y,x,t] = wallInfo[i];
         if(t === -1){
            wall.add(`${y},${x},${y-1},${x}`)
            wall.add(`${y-1},${x},${y},${x}`);
         }
         else{
            wall.add(`${y},${x},${y},${x+1}`);
            wall.add(`${y},${x+1},${y},${x}`)
         }
     }
    //  console.log(warmer);
     let chocolate = 0;
     while(chocolate < 100){
         warmer.forEach(w => blowWind(w,map,wall));
         map = controlTemper(map,wall);
         //console.log(map.map(row => row.join(' ')).join('\n'));
         decreaseEdgeTemper(map);
         chocolate++;
         const isFinish = checkTemper.every(([y,x]) => map[y][x] >= K);
         if(isFinish) return console.log(chocolate);
     }
     console.log(101);
}
solution(map);